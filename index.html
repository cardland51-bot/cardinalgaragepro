<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no" />
<title>HeroHUD • Upload → Analyze → Send</title>
<meta name="theme-color" content="#0b1b16" />
<style>
  :root{
    --bg-top:#0b1b16; --bg-bot:#06121a;
    --mintL:#9CFFE0; --mint:#34D1A0; --aqua:#2FB0E9; --teal:#0E8B67;
    --text:#E9FFF6; --textDim:rgba(233,255,246,.85);
    --glass:rgba(255,255,255,0.05); --stroke:rgba(156,255,224,0.28);
    --opaque:#0a1713;
    --deckBg:#0e1815;
  }
  html,body{margin:0;height:100%;background:linear-gradient(180deg,var(--bg-top),var(--bg-bot));color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;overscroll-behavior:none}
  *{box-sizing:border-box}

  /* Ambient films */
  body::before, body::after{content:""; position:fixed; inset:0; pointer-events:none}
  body::before{
    background:
      radial-gradient(130% 90% at 50% 6%, rgba(156,255,224,.10), transparent 45%),
      radial-gradient(120% 80% at 50% 95%, rgba(47,176,233,.12), transparent 55%);
    animation:film1 16s ease-in-out infinite alternate; opacity:.9;
  }
  body::after{
    background:
      linear-gradient( to right, transparent 0%, rgba(156,255,224,.05) 30%, transparent 60%),
      linear-gradient( to left,  transparent 0%, rgba(47,176,233,.05) 30%, transparent 60%);
    mix-blend-mode:screen; animation:film2 22s linear infinite; opacity:.7;
  }
  @keyframes film1{to{transform:translateY(-1.5%)}}
  @keyframes film2{to{transform:translateX(-2%)}}

  /* Topbar */
  .topbar{position:fixed;inset:0 0 auto 0;height:56px;display:flex;align-items:center;justify-content:space-between;padding:0 12px;z-index:40;background:linear-gradient(180deg, rgba(0,0,0,.45), rgba(0,0,0,.1));border-bottom:1px solid var(--stroke);backdrop-filter:blur(6px)}
  .brand{font-weight:900;letter-spacing:.08em;color:var(--mintL)}
  .menu{display:flex;gap:8px}
  .pill{border:1px solid var(--stroke);background:var(--glass);color:var(--text);cursor:pointer;border-radius:999px;padding:.45rem .85rem;font-size:12px;box-shadow:0 0 10px rgba(156,255,224,.18)}
  .pill:hover{box-shadow:0 0 22px rgba(156,255,224,.35)}
  .pill.locked{opacity:.55;cursor:not-allowed}

  /* Stage */
  .stage{position:fixed;inset:56px 0 148px 0;display:grid;place-items:center;padding:18px}
  .stack{display:flex;flex-direction:column;align-items:center;text-align:center;gap:12px;max-width:980px;width:100%}

  /* Buttons */
  .btn{appearance:none;border:1px solid var(--mint);background:var(--glass);color:var(--mintL);
    padding:.85rem 1.4rem;border-radius:999px;letter-spacing:.08em;text-transform:uppercase;font-weight:700;
    backdrop-filter:blur(6px);cursor:pointer;transition:box-shadow .2s,transform .1s,opacity .2s;
    box-shadow:0 0 16px rgba(156,255,224,.14);font-size:13px;position:relative;overflow:hidden;user-select:none}
  .btn:hover{box-shadow:0 0 26px rgba(156,255,224,.45),0 0 24px rgba(47,176,233,.25)}
  .btn:active{transform:translateY(1px)}
  .btn.hidden{display:none}
  .btn.locked{opacity:.55;cursor:not-allowed}
  .btn-row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}

  /* Preview */
  #preview{display:none;position:relative;width:min(94vw,980px);aspect-ratio:16/10;border-radius:16px;overflow:hidden;border:1px solid var(--stroke);box-shadow:0 0 24px rgba(156,255,224,.14)}
  #preview img,#preview video{width:100%;height:100%;object-fit:cover}
  #edgeGlow{position:absolute;inset:0;border-radius:16px;pointer-events:none;opacity:0;
    box-shadow:0 0 28px rgba(156,255,224,.6),inset 0 0 18px rgba(14,139,103,.55);transition:opacity .25s}
  .glow-on #edgeGlow{opacity:1}
  .wheel{position:absolute;inset:auto auto 10px 10px;background:rgba(0,0,0,.45);border:1px solid var(--stroke);
    border-radius:999px;padding:.35rem .6rem;font-size:12px;display:flex;gap:.5rem;align-items:center}
  .mini-spin{width:14px;height:14px;border-radius:50%;border:2px solid rgba(156,255,224,.35);border-top-color:var(--mintL);animation:spin 1s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* Tip bubbles IN the photo (absolute, random) */
  .tipAbs{
    position:absolute;
    min-width:120px; max-width:46%;
    background:rgba(15,25,22,.86);
    border:1px solid var(--stroke);
    color:var(--text);
    padding:.55rem .7rem;border-radius:10px;
    box-shadow:0 0 18px rgba(156,255,224,.25);
    font-size:13px; line-height:1.3;
    opacity:0; transform:translateY(8px);
    transition:all .45s cubic-bezier(.2,.9,.2,1);
    pointer-events:none;
  }
  .tipAbs.show{opacity:1;transform:translateY(0)}

  /* HUD tabs */
  .hud{display:none;gap:8px;margin-top:8px;flex-wrap:wrap;justify-content:center}
  .tab{padding:.45rem .8rem;border:1px solid var(--stroke);border-radius:999px;background:rgba(255,255,255,.04);color:var(--textDim);font-size:12px}

  /* Garage (opaque) */
  #garageDoor{position:fixed;left:0;right:0;top:0;height:0;overflow:hidden;z-index:70;pointer-events:none}
  #garageDoor .door{
    height:520px;background:var(--opaque);
    border-bottom:1px solid var(--stroke);
    box-shadow:0 10px 40px rgba(0,0,0,.55);
    display:flex;flex-direction:column;align-items:center;gap:12px;padding:18px 12px; position:relative; color:var(--text);
  }
  #garageDoor.open{height:520px;pointer-events:auto;transition:height .9s cubic-bezier(.2,.9,.2,1)}
  #garageDoor.close{height:0;transition:height .8s cubic-bezier(.2,.9,.2,1)}
  .gTitle{font-weight:900;letter-spacing:.16em;color:var(--mintL);margin-top:2px}
  .gClose{position:absolute;right:10px;top:10px;border:1px solid var(--stroke);background:#0e1815;color:var(--text);border-radius:999px;padding:.35rem .6rem;cursor:pointer}
  .gRow{display:flex;gap:12px;max-width:1120px;width:calc(100% - 24px);justify-content:center;flex-wrap:wrap;margin-top:6px}
  .card{flex:1 1 280px;max-width:340px;background:#0e1815;border:1px solid var(--stroke);border-radius:14px;padding:12px 12px 14px;box-shadow:0 0 26px rgba(156,255,224,.12)}
  .tag{display:inline-block;border:1px solid var(--mint);color:var(--mintL);padding:.25rem .5rem;border-radius:999px;font-size:11px;margin-bottom:8px}
  .price{margin-top:8px;opacity:.9}
  .card .btn-row{justify-content:flex-start}
  .card a.action{display:inline-block;margin-top:8px;color:var(--mintL);text-decoration:underline;cursor:pointer}

  /* Paywall (daily limit for uploads only) */
  .overlay{display:none;position:fixed;inset:0;background:rgba(3,8,6,.86);backdrop-filter:blur(6px);align-items:center;justify-content:center;z-index:90}
  .panel{max-width:560px;margin:20px;background:#0f1916;border:1px solid var(--stroke);border-radius:16px;padding:1.1rem 1.3rem;text-align:center;box-shadow:0 0 32px rgba(156,255,224,.28)}

  /* Boot chamber */
  #bootVeil{position:fixed;inset:0;background:#03100c;z-index:95;display:flex;align-items:center;justify-content:center;flex-direction:column}
  #bootWheel{display:flex;gap:.6rem;align-items:center;border:1px solid var(--stroke);background:#0e1815;padding:.7rem 1rem;border-radius:999px}
  #bootWheel .mini-spin{border-color:rgba(156,255,224,.35);border-top-color:var(--mintL)}
  #bootMsg{margin-top:12px;color:var(--textDim);font-size:14px}
  #btnEnableAudio{margin-top:14px}

  /* Dedication */
  #dedication{position:fixed;inset:0;z-index:94;display:none;align-items:center;justify-content:center;flex-direction:column;background:radial-gradient(80% 60% at 50% 40%, rgba(156,255,224,.06), transparent 60%)}
  #dedication .line{font-weight:800;letter-spacing:.18em;color:var(--mintL);text-align:center}
  #dedication .sub{margin-top:8px;color:var(--textDim);font-size:14px}

  /* Toast push */
  #toast{
    position:fixed;left:50%;transform:translateX(-50%) translateY(120%);bottom:16px;
    width:min(90vw,480px);background:rgba(15,25,22,.96);border:1px solid var(--stroke);border-radius:14px;
    box-shadow:0 18px 40px rgba(0,0,0,.45), 0 0 24px rgba(156,255,224,.18);
    color:var(--text);z-index:100; padding:12px 12px 10px;transition:transform .35s ease, opacity .35s ease; opacity:0;
  }
  #toast.show{transform:translateX(-50%) translateY(0);opacity:1}
  #toast .t-title{font-weight:700;margin-bottom:4px;color:var(--mintL)}
  #toast .t-body{font-size:13px;color:var(--textDim)}
  #toast .t-actions{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
  #toast .t-actions .btn{padding:.55rem .9rem;text-transform:none;font-weight:700;border-color:var(--stroke);color:var(--text)}

  /* Deck Mode (Founders Deck) */
  #deckOverlay{
    position:fixed; inset:0; z-index:92; display:none; background:linear-gradient(180deg,#0a1411,#07110e);
  }
  .deckWrap{
    position:absolute; inset:56px 0 0 0; display:flex; align-items:center; justify-content:center; padding:24px;
  }
  .slide{
    width:min(1100px,92vw); min-height:min(72vh,760px);
    background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
    border:1px solid var(--stroke); border-radius:18px; padding:28px;
    color:var(--text); box-shadow:0 0 26px rgba(156,255,224,.14);
    display:none;
  }
  .slide.show{display:block;animation:slideIn .35s ease}
  @keyframes slideIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
  .sTitle{font-weight:900; letter-spacing:.12em; color:var(--mintL); font-size:clamp(20px,3.4vw,32px); margin-bottom:8px}
  .sSub{opacity:.9;margin-bottom:14px}
  .sGrid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .sCard{background:#0e1815;border:1px solid var(--stroke);border-radius:12px;padding:12px}
  .navDeck{position:absolute; left:0; right:0; top:56px; height:44px; display:flex; align-items:center; justify-content:center; gap:8px}
  .deckBtn{border:1px solid var(--stroke);background:var(--glass);color:var(--text);border-radius:999px;padding:.35rem .8rem;font-size:12px;cursor:pointer}
  .deckRight{position:absolute; right:12px; top:6px; display:flex; gap:8px}
  .deckPager{position:absolute; bottom:18px; left:50%; transform:translateX(-50%); font-size:12px; color:var(--textDim)}
  @media print{
    body{background:#fff;color:#111}
    #deckOverlay{display:block !important; background:#fff}
    .slide{width:100%; min-height:auto; color:#111; border-color:#ccc; box-shadow:none}
    .sCard{background:#fff;border-color:#ddd}
    .topbar, .stage, #garageDoor, #bootVeil, #dedication{display:none !important}
    .navDeck, .deckRight{display:none !important}
  }

  /* Footer */
  .footer{position:fixed;left:50%;transform:translateX(-50%);bottom:14px;font-size:12px;color:rgba(233,255,246,.7);letter-spacing:.12em;text-transform:uppercase}

  /* Mobile safe area */
  @supports(padding:max(0px)){
    .footer{bottom:calc(14px + env(safe-area-inset-bottom))}
    #toast{bottom:calc(16px + env(safe-area-inset-bottom))}
  }
</style>
</head>
<body>
  <div class="topbar">
    <div class="brand">HeroHUD</div>
    <div class="menu">
      <button class="pill" id="btnFull">Full Screen</button>
      <button class="pill" id="btnGarage">Open Cardinal Garage</button>
      <button class="pill" id="btnOpenDeck">Open Founders Deck</button>
    </div>
  </div>

  <!-- Boot chamber -->
  <div id="bootVeil" aria-hidden="true">
    <div id="bootWheel"><div class="mini-spin"></div><span>Waking up…</span></div>
    <div id="bootMsg">Server configuring • Back end live • Please give Jared time to wake up</div>
    <button class="pill" id="btnEnableAudio">Enable Sound</button>
  </div>

  <!-- Dedication -->
  <div id="dedication">
    <div class="line" style="font-size:clamp(16px,2.6vw,22px);opacity:.9">Dedicated to Addison</div>
    <div class="line" style="font-size:clamp(22px,4.2vw,38px);margin-top:6px">Precision meets Grit</div>
    <div class="line" style="font-size:clamp(18px,3.2vw,28px);opacity:.9">Heart meets Hustle</div>
    <div class="sub">— glow —</div>
  </div>

  <div class="stage">
    <div class="stack">
      <!-- Primary controls -->
      <div class="btn-row">
        <button class="btn" id="btnUpload">Upload Photo</button>
        <button class="btn" id="btnCameraTop">Camera</button>
        <button class="btn" id="btnAnalyze">Analyze</button>
        <button class="btn" id="btnReset">Reset</button>
        <button class="btn hidden" id="btnExport">Download Log (.txt)</button>
      </div>

      <!-- Preview -->
      <div id="preview">
        <img id="previewImg" alt="preview"/>
        <div id="edgeGlow"></div>
        <div class="wheel" id="wheel" style="display:none;"><div class="mini-spin"></div><span id="wheelText">Analyzing…</span></div>
        <div id="dashHint" style="position:absolute;inset:0;opacity:.0;pointer-events:none;"></div>
      </div>

      <!-- Modules hint -->
      <div class="hud" id="hudTabs">
        <div class="tab">Insights</div>
        <div class="tab">Field Guides</div>
        <div class="tab">Best Practices</div>
        <div class="tab">Sales University</div>
        <div class="tab">Ledger</div>
        <div class="tab">Founders</div>
      </div>

      <input type="file" id="file" accept="image/*" hidden />
    </div>
  </div>

  <!-- Toast push summary -->
  <div id="toast">
    <div class="t-title">Analysis Complete</div>
    <div class="t-body" id="toastBody">Summary will appear here…</div>
    <div class="t-actions">
      <button class="btn" id="toastViewLog">View Full Log</button>
      <button class="btn" id="toastBestPractices">Best Practices</button>
      <button class="btn" id="toastFieldGuides">Field Guides</button>
    </div>
  </div>

  <!-- Garage (opaque) -->
  <div id="garageDoor" class="close" aria-hidden="true">
    <div class="door">
      <button class="gClose" id="garageCloseBtn">Close</button>
      <div class="gTitle">CARDINAL GARAGE • High-Tier Access</div>
      <div style="opacity:.9;font-size:12px;margin-top:-4px">Payments • Sales University • Best Practices • Field Guides • Founder Ops</div>

      <div class="gRow">
        <div class="card" id="cardAccess">
          <span class="tag">Access+</span>
          <div>Unlimited uploads & analyses. Controls daily caps only.</div>
          <div class="price">$25 / month</div>
          <div class="btn-row">
            <button class="btn" id="btnAccessActivate">Activate (PayPal)</button>
            <a class="action" id="linkAccess" href="#" target="_blank" rel="noopener">Open Payment Page</a>
          </div>
        </div>

        <div class="card" id="cardBestPractices">
          <span class="tag">Best Practices</span>
          <div>Situational playbooks for confident execution.</div>
          <div class="price">$29 one-time</div>
          <div class="btn-row">
            <button class="btn" id="btnBPBuy">Buy (PayPal)</button>
            <a class="action" id="linkBP" href="#" target="_blank" rel="noopener">Open Payment Page</a>
          </div>
        </div>

        <div class="card" id="cardFieldGuides">
          <span class="tag">Field Guides</span>
          <div>Tools + materials lists with quick methods.</div>
          <div class="price">$19 one-time</div>
          <div class="btn-row">
            <button class="btn" id="btnFGBuy">Buy (PayPal)</button>
            <a class="action" id="linkFG" href="#" target="_blank" rel="noopener">Open Payment Page</a>
          </div>
        </div>

        <div class="card" id="cardSalesU">
          <span class="tag">Sales University</span>
          <div>Addie-led 1-week sprint • junior & pro tracks.</div>
          <div class="price">$99 / week</div>
          <div class="btn-row">
            <button class="btn" id="btnSalesUEnter">Enter</button>
            <button class="btn" id="btnSalesUExtraDemo">Grant 1 Extra Demo</button>
            <a class="action" id="linkSU" href="#" target="_blank" rel="noopener">Open Payment Page</a>
          </div>
        </div>

        <div class="card" id="cardFounders">
          <span class="tag">Founders</span>
          <div>Control center, ledger, projections, detailed deck.</div>
          <div class="btn-row">
            <button class="btn" id="btnOpenDeck2">Open Founders Deck</button>
            <button class="btn" id="btnDownloadLogs">Download Logs</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Paywall (uploads daily cap only) -->
  <div class="overlay" id="paywall">
    <div class="panel">
      <h3 id="paywallTitle">Access Limit Reached</h3>
      <p id="paywallMsg" class="sub">Unlock Access+ for unlimited uploads & analyses.</p>
      <div class="btn-row">
        <button class="btn" id="btnPayAccess">Activate Access+ (PayPal)</button>
        <button class="btn" id="btnPaywallClose">Close</button>
      </div>
    </div>
  </div>

  <!-- Deck Mode -->
  <div id="deckOverlay">
    <div class="navDeck">
      <button class="deckBtn" id="deckPrev">‹ Prev</button>
      <button class="deckBtn" id="deckNext">Next ›</button>
      <div class="deckRight">
        <button class="deckBtn" id="deckPrint">Print</button>
        <button class="deckBtn" id="deckExit">Exit Deck</button>
      </div>
    </div>
    <div class="deckWrap">
      <!-- Slides -->
      <div class="slide show">
        <div class="sTitle">HeroHUD — Value Engine for the Field</div>
        <div class="sSub">Upload → Analyze → Send • Dark-mint glass UI • Voice-assisted coaching</div>
        <div class="sGrid">
          <div class="sCard"><b>Mission</b><br/>Give pros, teens, and teams a precise, voice-guided way to turn a yard photo into confident work and sales.</div>
          <div class="sCard"><b>Tagline</b><br/>Precision meets Grit.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">What It Is</div>
        <div class="sGrid">
          <div class="sCard"><b>Command Deck</b><br/>Single-file, high-performance UI: upload, camera, analyze, tip overlays, log export.</div>
          <div class="sCard"><b>Two Voices</b><br/>Addie (payments, Sales U), Jared (analysis & coaching). No chat boxes — tips overlay on the photo.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">How It Works</div>
        <div class="sGrid">
          <div class="sCard"><b>Analyze</b><br/>Image → backend → structured summary + tools/materials/technique lines. Jared reads; tips float.</div>
          <div class="sCard"><b>Export</b><br/>One-click .txt log export (free). Pro PDFs optional later; today we keep it light & fast.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Triple Market</div>
        <div class="sGrid">
          <div class="sCard"><b>Pros</b><br/>Close more with Pro Sales Insight and repeatable best practices.</div>
          <div class="sCard"><b>Parents & Teens (14–18)</b><br/>Junior portal to earn with a mower + guidance; Addie leads training.</div>
        </div>
        <div class="sCard" style="margin-top:12px"><b>Partners</b><br/>Suppliers & brands — digital franchise & licensed training.</div>
      </div>

      <div class="slide">
        <div class="sTitle">Organic Leverage & Groups</div>
        <div class="sGrid">
          <div class="sCard"><b>Community First</b><br/>Share results into neighborhood & trade groups; “before/after + tips” templates.</div>
          <div class="sCard"><b>Seeding Play</b><br/>Target global lawncare, landscaping, handyman groups; consistent tone & cadence.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Public Momentum</div>
        <div class="sGrid">
          <div class="sCard"><b>Launch</b><br/>Weekly challenges, featured juniors, transparent build logs.</div>
          <div class="sCard"><b>Proof Loops</b><br/>User wins → screenshots → shares → new users → more wins.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Flywheel</div>
        <div class="sGrid">
          <div class="sCard"><b>Input</b><br/>Uploads & training.</div>
          <div class="sCard"><b>Output</b><br/>Better quotes, faster ops, social proof, referrals, partners.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Tech Stack (Today)</div>
        <div class="sGrid">
          <div class="sCard"><b>Front</b><br/>Single index.html • Web Speech • Dark-mint glass CSS • Mobile-first.</div>
          <div class="sCard"><b>Back</b><br/>Render Node/Express endpoints: /analyze-image, /export (txt), future: /founder-metrics.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Efficiency Ratio (Method)</div>
        <div class="sGrid">
          <div class="sCard"><b>Definition</b><br/>Revenue added or time saved per analysis minute (RAM/TSM).</div>
          <div class="sCard"><b>Example</b><br/>If 10 min analysis yields +$80 margin confidence → 8.0 RAM; time saved 25 min → 2.5 TSM.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Unit Economics (Illustrative)</div>
        <div class="sGrid">
          <div class="sCard"><b>Access+</b><br/>$25/mo. Goal: ≥8 analyses/mo → <$3.13/analysis.</div>
          <div class="sCard"><b>Pro Add-ons</b><br/>Best Practices $29; Field Guides $19; Sales U $99/wk.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Digital Franchise</div>
        <div class="sGrid">
          <div class="sCard"><b>Cardinal Garage</b><br/>Licensing + playbooks + brand trust + payment rails.</div>
          <div class="sCard"><b>Compliance</b><br/>Clear boundaries: analysis ≠ binding quote; local pricing inputs.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Roadmap</div>
        <div class="sGrid">
          <div class="sCard"><b>Near</b><br/>Faster tips, more field templates, partner pilots.</div>
          <div class="sCard"><b>Next</b><br/>Region price models, AR overlays, multi-crew workflows.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Risks & Mitigations</div>
        <div class="sGrid">
          <div class="sCard"><b>Quality</b><br/>Human-in-the-loop, best-practice guardrails.</div>
          <div class="sCard"><b>Adoption</b><br/>Junior success stories + pro testimonials + transparent training.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Team & Voices</div>
        <div class="sGrid">
          <div class="sCard"><b>Addie</b><br/>Payments • Sales U • Garage.</div>
          <div class="sCard"><b>Jared</b><br/>Analysis reader • tools/tips/techniques coach.</div>
        </div>
      </div>

      <div class="slide">
        <div class="sTitle">Ask / Next Step</div>
        <div class="sGrid">
          <div class="sCard"><b>Momentum</b><br/>We’re a value machine — compounding outcomes, not noise.</div>
          <div class="sCard"><b>Join</b><br/>Pilot partners • junior cohorts • local franchises.</div>
        </div>
        <div class="sSub" style="margin-top:12px">Powered by Cardinal-Garage_MND Inc.</div>
      </div>

      <div class="deckPager" id="deckPager">1 / 14</div>
    </div>
  </div>

  <div class="footer">Powered by Cardinal-Garage_MND Inc.</div>

<script>
(() => {
  /* ========= CONFIG ========= */
  const API = (location.hostname.includes("localhost")||location.hostname.includes("127.0.0.1"))
    ? "http://localhost:3001"
    : "https://jared-hero2-backend.onrender.com";
  const PAYPAL_URL = "https://www.paypal.com/ncp/payment/MVWW6VPEHJKKU";

  /* ========= ELEMENTS ========= */
  const el = {
    file: qs('#file'),
    btnUpload: qs('#btnUpload'),
    btnCameraTop: qs('#btnCameraTop'),
    btnAnalyze: qs('#btnAnalyze'),
    btnReset: qs('#btnReset'),
    btnExport: qs('#btnExport'),
    preview: qs('#preview'),
    previewImg: qs('#previewImg'),
    edgeGlow: qs('#edgeGlow'),
    wheel: qs('#wheel'),
    wheelText: qs('#wheelText'),
    dashHint: qs('#dashHint'),
    hudTabs: qs('#hudTabs'),
    btnFull: qs('#btnFull'),
    btnGarage: qs('#btnGarage'),
    btnOpenDeck: qs('#btnOpenDeck'),
    bootVeil: qs('#bootVeil'),
    bootMsg: qs('#bootMsg'),
    btnEnableAudio: qs('#btnEnableAudio'),
    dedication: qs('#dedication'),
    toast: qs('#toast'),
    toastBody: qs('#toastBody'),
    toastViewLog: qs('#toastViewLog'),
    toastBestPractices: qs('#toastBestPractices'),
    toastFieldGuides: qs('#toastFieldGuides'),
    garageDoor: qs('#garageDoor'),
    garageCloseBtn: qs('#garageCloseBtn'),
    btnAccessActivate: qs('#btnAccessActivate'),
    btnBPBuy: qs('#btnBPBuy'),
    btnFGBuy: qs('#btnFGBuy'),
    btnSalesUEnter: qs('#btnSalesUEnter'),
    btnSalesUExtraDemo: qs('#btnSalesUExtraDemo'),
    btnDownloadLogs: qs('#btnDownloadLogs'),
    linkAccess: qs('#linkAccess'),
    linkBP: qs('#linkBP'),
    linkFG: qs('#linkFG'),
    linkSU: qs('#linkSU'),
    paywall: qs('#paywall'),
    btnPaywallClose: qs('#btnPaywallClose'),
    btnPayAccess: qs('#btnPayAccess'),
    btnOpenDeck2: qs('#btnOpenDeck2'),
    deckOverlay: qs('#deckOverlay'),
    deckPrev: qs('#deckPrev'),
    deckNext: qs('#deckNext'),
    deckPrint: qs('#deckPrint'),
    deckExit: qs('#deckExit'),
    deckPager: qs('#deckPager'),
  };

  /* ========= STATE ========= */
  const STATE = {
    accessUnlocked: localStorage.getItem('herohud_access_unlocked')==='1',
    uploadsToday: getUploadsToday(),
    logs: loadLogs(), // { startedAt, entries: [] }
    lastSummary: "",
    lastRecommendation: "",
    analyzing: false,
    audioEnabled: false,
    addieFinished: false,
    deckIndex: 0,
  };

  /* ========= UTIL ========= */
  function qs(s){ return document.querySelector(s); }
  function qsa(s){ return Array.from(document.querySelectorAll(s)); }
  function nowKey(){ const d=new Date(); return `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}` }
  function getUploadsToday(){
    const key = localStorage.getItem('herohud_uploads_key');
    const count = Number(localStorage.getItem('herohud_uploads_count')||0);
    const today = nowKey();
    return key===today?count:0;
  }
  function bumpUploads(){
    const today = nowKey();
    localStorage.setItem('herohud_uploads_key', today);
    const n = STATE.uploadsToday+1;
    localStorage.setItem('herohud_uploads_count', String(n));
    STATE.uploadsToday = n;
  }
  function escapeHTML(s){return s.replace(/[&<>"']/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]))}
  function wait(ms){ return new Promise(r=>setTimeout(r,ms)) }
  function log(kind, payload){ STATE.logs.entries.push({ t:Date.now(), kind, payload }); localStorage.setItem('herohud_logs', JSON.stringify(STATE.logs)); }
  function loadLogs(){ const raw=localStorage.getItem('herohud_logs'); return raw?JSON.parse(raw):{ startedAt: Date.now(), entries: [] } }
  function rand(min,max){ return Math.random()*(max-min)+min }
  function clamp(v,min,max){ return Math.max(min,Math.min(max,v)); }

  /* ========= SPEECH (Addie/Jared) ========= */
  let speaking = false;
  let activeUtter = null;

  function pickVoice(preferFemale=true){
    const voices = window.speechSynthesis.getVoices();
    if(!voices || !voices.length) return null;
    if(preferFemale){
      return voices.find(v=>/Amelia|Jenny|Zira|Samantha|Google US English|Female|Neural/i.test(v.name)) || voices[0];
    }else{
      return voices.find(v=>/Daniel|Alex|Matthew|Guy|Male|Neural/i.test(v.name)) || voices[0];
    }
  }

  function speak(text, {female=false, rate=1.02, pitch=1.0, onend}={}){
    if(!STATE.audioEnabled){ onend && onend(); return; }
    try{
      if(activeUtter){ window.speechSynthesis.cancel(); activeUtter=null; speaking=false; }
      const u = new SpeechSynthesisUtterance(text);
      const v = pickVoice(female);
      if(v) u.voice = v;
      u.rate = rate; u.pitch = pitch;
      u.onend = () => { speaking=false; activeUtter=null; onend && onend(); };
      u.onerror = () => { speaking=false; activeUtter=null; onend && onend(); };
      speaking = true; activeUtter = u;
      window.speechSynthesis.speak(u);
      log('voice', { text, female });
    }catch(e){ onend && onend(); }
  }
  function stopSpeech(){ if(activeUtter){ window.speechSynthesis.cancel(); activeUtter=null; speaking=false; } }

  /* ========= BOOT SEQUENCE ========= */
  async function boot(){
    // 2.5–3.2s chamber spin (mobile waits for tap to enable audio first)
    await wait(2600 + Math.floor(Math.random()*700));

    // Start Addie near the end of boot (sounds like she's arriving)
    const startAddie = () => {
      const script =
        "Hey—I'm Addie. This dark-mint deck is your command space. " +
        "Upload a photo, tap Analyze, and Jared—your field strategist—reads the findings with precise tips. " +
        "I handle payments, Sales University, and the Cardinal Garage. " +
        "You can replay me later; for now, let’s get you moving.";
      speak(script, { female:true, rate:1.0, pitch:1.06, onend:()=>{ STATE.addieFinished=true; }});
    };

    if(STATE.audioEnabled) startAddie();

    // Fade boot → dedication (3s) → HUD
    el.bootVeil.style.display='none';
    el.dedication.style.display='flex';
    await wait(3000);
    el.dedication.style.display='none';
  }

  /* ========= FULLSCREEN / GARAGE ========= */
  el.btnFull.onclick = () => {
    if(!document.fullscreenElement) document.documentElement.requestFullscreen().catch(()=>{});
    else document.exitFullscreen();
  };
  el.btnGarage.onclick = () => openGarage();
  el.btnOpenDeck.onclick = openDeck;
  el.btnOpenDeck2.onclick = openDeck;

  function openGarage(target){
    el.garageDoor.classList.remove('close'); el.garageDoor.classList.add('open');
    if(target==='best'){ setTimeout(()=>qs('#cardBestPractices').scrollIntoView({behavior:'smooth',block:'center'}), 100); }
    if(target==='field'){ setTimeout(()=>qs('#cardFieldGuides').scrollIntoView({behavior:'smooth',block:'center'}), 100); }
  }
  function closeGarage(){ el.garageDoor.classList.remove('open'); el.garageDoor.classList.add('close'); }
  el.garageCloseBtn.onclick = closeGarage;

  /* ========= DAILY GATE (uploads only) ========= */
  function canUpload(){
    const extraDemo = Number(localStorage.getItem('herohud_extra_demo')||0);
    const freeLimit = 2 + extraDemo;
    return STATE.accessUnlocked || STATE.uploadsToday < freeLimit;
  }
  function enforceUploadGate(){
    if(canUpload()) return true;
    el.paywall.style.display='flex';
    return false;
  }
  el.btnPaywallClose.onclick = ()=> el.paywall.style.display='none';

  /* ========= PAYMENTS (PayPal URL) ========= */
  function openPaypal(product){
    const url = `${PAYPAL_URL}?product=${encodeURIComponent(product)}`;
    window.open(url,'_blank','noopener');
  }
  // Garage buttons
  el.btnAccessActivate.onclick = ()=> { openPaypal('AccessPlus'); };
  el.btnBPBuy.onclick = ()=> { openPaypal('BestPractices'); };
  el.btnFGBuy.onclick = ()=> { openPaypal('FieldGuides'); };
  el.linkAccess.onclick = (e)=>{ e.preventDefault(); openPaypal('AccessPlus'); };
  el.linkBP.onclick = (e)=>{ e.preventDefault(); openPaypal('BestPractices'); };
  el.linkFG.onclick = (e)=>{ e.preventDefault(); openPaypal('FieldGuides'); };
  el.linkSU.onclick = (e)=>{ e.preventDefault(); openPaypal('SalesUniversity'); };
  // Paywall primary CTA
  el.btnPayAccess.onclick = ()=> { openPaypal('AccessPlus'); };

  /* ========= CAMERA ========= */
  el.btnCameraTop.onclick = openCamera;
  let camStream=null, camVideo=null, captureBtn=null;
  async function openCamera(){
    if(!enforceUploadGate()) return;
    try{
      const stream=await navigator.mediaDevices.getUserMedia({video:true});
      camStream=stream;
      camVideo=document.createElement("video");
      camVideo.playsInline=true; camVideo.muted=true; camVideo.srcObject=stream; await camVideo.play();
      el.preview.style.display='block'; previewReplaceWithNode(camVideo); ensureCaptureBtn();
      tipAbs("Camera online. Capture when ready.", .12, .82);
    }catch(e){ tipAbs("Camera access denied.", .14, .16); }
  }
  function ensureCaptureBtn(){
    if(captureBtn) captureBtn.remove();
    captureBtn=document.createElement("button");
    captureBtn.textContent="Capture";
    captureBtn.className="btn";
    captureBtn.style.position="absolute"; captureBtn.style.right="10px"; captureBtn.style.bottom="10px";
    el.preview.appendChild(captureBtn);
    captureBtn.onclick=async()=>{
      if(!camVideo) return;
      const canvas=document.createElement("canvas");
      canvas.width=camVideo.videoWidth||1280; canvas.height=camVideo.videoHeight||720;
      const g=canvas.getContext("2d"); g.drawImage(camVideo,0,0,canvas.width,canvas.height);
      const blob=await new Promise(res=>canvas.toBlob(res,'image/jpeg',0.92));
      if(camStream){camStream.getTracks().forEach(t=>t.stop()); camStream=null;}
      camVideo=null;
      const url=URL.createObjectURL(blob); previewReplaceWithImage(url);
      el.preview.style.display='block'; el.dashHint.style.opacity=.25;
      el.file._capturedBlob = blob;
      bumpUploads(); tipAbs("Captured — tap Analyze.", .78, .86);
      log('camera_capture', { size: blob.size });
    };
  }

  /* ========= PREVIEW HELPERS ========= */
  function previewReplaceWithImage(url){
    const img=document.createElement("img");
    img.id="previewImg"; img.alt="preview"; img.src=url;
    previewReplaceWithNode(img);
  }
  function previewReplaceWithNode(node){
    const old=el.preview.querySelector("img,video");
    if(old) old.replaceWith(node); else el.preview.prepend(node);
  }

  /* ========= TIPS (absolute inside photo) ========= */
  function tipAbs(text, fracX, fracY){
    // fracX/Y 0..1 relative to preview
    const t = document.createElement('div');
    t.className = 'tipAbs';
    t.textContent = text;
    el.preview.appendChild(t);
    // position after added (measure)
    const rect = el.preview.getBoundingClientRect();
    const w = rect.width, h = rect.height;
    const tx = clamp(fracX ?? Math.random()*0.8+0.1, 0.06, 0.86);
    const ty = clamp(fracY ?? Math.random()*0.8+0.1, 0.08, 0.88);
    t.style.left = Math.round(w*tx) + 'px';
    t.style.top  = Math.round(h*ty) + 'px';
    requestAnimationFrame(()=>t.classList.add('show'));
    return t;
  }
  function clearTipAbs(){ qsa('.tipAbs').forEach(n=>n.remove()); }

  function showAnalysisTips(summary){
    const bits=(summary||"Define bed edge; set mulch depth; align shrub spacing.")
      .replace(/\s+/g,' ').trim().split(/[.;]/).map(s=>s.trim()).filter(Boolean).slice(0,3);
    const spots = [[.15,.78],[.76,.18],[.58,.72]];
    bits.forEach((b,i)=> setTimeout(()=> tipAbs(b, spots[i]?.[0], spots[i]?.[1]), 200 + i*900));
  }

  /* ========= EXPORT (.txt ONLY — ALWAYS FREE) ========= */
  el.btnExport.onclick = () => {
    const text = buildTxtLog();
    downloadTxt(`herohud_analysis_${dateStamp()}.txt`, text);
    log('export_txt', {});
  };
  function buildTxtLog(){
    const tipsTxt=qsa('.tipAbs').map(e=>e.textContent.trim()).join("\n");
    const payload = {
      summary: STATE.lastSummary || "",
      recommendation: STATE.lastRecommendation || "",
      tips: tipsTxt || "",
      logs: STATE.logs
    };
    return [
      "HeroHUD Analysis Log",
      "====================",
      "",
      "Summary:",
      payload.summary,
      "",
      "Recommendation:",
      payload.recommendation,
      "",
      "Tips:",
      payload.tips,
      "",
      "Voice/Action Log:",
      JSON.stringify(payload.logs, null, 2),
      ""
    ].join("\n");
  }
  function downloadTxt(filename, text){
    const blob=new Blob([text],{type:"text/plain"});
    const a=document.createElement("a"); a.href=URL.createObjectURL(blob); a.download=filename; a.click();
  }
  function dateStamp(){
    const d=new Date();
    const z=n=>String(n).padStart(2,'0');
    return `${d.getFullYear()}${z(d.getMonth()+1)}${z(d.getDate())}_${z(d.getHours())}${z(d.getMinutes())}${z(d.getSeconds())}`;
  }

  /* ========= PUSH-STYLE TOAST ========= */
  function showToast(summary, recommendation){
    const firstLine = (summary||"").split(/[.;]/).map(s=>s.trim()).filter(Boolean)[0] || "Analysis ready.";
    const topRec = (recommendation||"").split(/[.;]/).map(s=>s.trim()).filter(Boolean)[0] || "";
    el.toastBody.textContent = topRec ? `${firstLine} • ${topRec}` : firstLine;
    el.toast.classList.add('show');
    setTimeout(()=> el.toast.classList.remove('show'), 6000);
  }
  el.toastViewLog.onclick = ()=> el.btnExport.click();
  el.toastBestPractices.onclick = ()=> openGarage('best');
  el.toastFieldGuides.onclick = ()=> openGarage('field');

  /* ========= ANALYZE ========= */
  el.btnAnalyze.onclick = async ()=>{
    if(!el.preview.style.display || el.preview.style.display==='none'){ tipAbs("Upload or capture a photo first.", .5, .5); return; }
    const blob = el.file._capturedBlob;
    const fileEl = el.file.files && el.file.files[0];
    if(!blob && !fileEl){ tipAbs("No image found.", .5, .5); return; }

    STATE.analyzing = true;
    clearTipAbs();
    el.preview.classList.add('glow-on');
    el.wheel.style.display='flex'; el.wheelText.textContent = "Analyzing…";
    stopSpeech(); // prevent overlap with Addie

    log('analyze_start', {});

    const formData=new FormData();
    if(blob) formData.append("file",blob,"capture.jpg"); else formData.append("file",fileEl);

    try{
      const resp = await fetch(`${API}/analyze-image`, { method:"POST", body:formData });
      const data = await resp.json();
      const summary = data.summary || "Analysis complete.";
      const rec = data.recommendation || deriveRecommendation(summary);
      STATE.lastSummary = summary;
      STATE.lastRecommendation = rec;
      log('analyze_result', { summary, recommendation: rec });

      // Jared voice (neutral/male), human cadence
      speak(summary, { female:false, rate:0.98, pitch:1.0, onend:()=> {
        showToast(summary, rec);
      }});
      showAnalysisTips(summary);
      el.hudTabs.style.display='flex';
      el.btnExport.classList.remove('hidden');
      el.dashHint.style.opacity=.6;
    }catch(e){
      tipAbs("Analysis failed. Please try again.", .5, .5);
      log('analyze_error', { msg:String(e) });
    } finally {
      el.wheel.style.display='none';
      el.preview.classList.remove('glow-on');
      STATE.analyzing = false;
    }
  };

  function deriveRecommendation(summary){
    const s = (summary||"").replace(/\s+/g,' ').trim();
    if(!s) return "Proceed with standard site prep and edging pass.";
    const first = s.split(/[.;]/).map(x=>x.trim()).filter(Boolean)[0] || s;
    return first.length>110 ? first.slice(0,108)+"…" : first;
  }

  /* ========= FILE UPLOAD ========= */
  el.btnUpload.onclick = ()=> { if(!enforceUploadGate()) return; el.file.click(); };
  el.file.onchange=()=>{
    const f=el.file.files[0]; if(!f) return;
    const url=URL.createObjectURL(f);
    previewReplaceWithImage(url);
    el.preview.style.display='block';
    el.dashHint.style.opacity=.25;
    bumpUploads();
    tipAbs("Photo loaded — tap Analyze.", .84, .86);
    log('upload', { name:f.name, size:f.size });
  };

  /* ========= RESET ========= */
  el.btnReset.onclick = ()=>{
    clearTipAbs();
    el.preview.style.display='none';
    el.file.value = "";
    el.file._capturedBlob = null;
    STATE.lastSummary = "";
    STATE.lastRecommendation = "";
    stopSpeech();
  };

  /* ========= FOUNDERS OPS ========= */
  el.btnDownloadLogs.onclick = ()=> {
    const text = JSON.stringify(STATE.logs, null, 2);
    downloadTxt(`herohud_logs_${dateStamp()}.txt`, text);
  };

  /* ========= SALES U / DEMO ========= */
  el.btnSalesUEnter.onclick = ()=> {
    alert("Sales University entry — placeholder (Addie will guide modules).");
  };
  el.btnSalesUExtraDemo.onclick = ()=> {
    const extra = Number(localStorage.getItem('herohud_extra_demo')||0) + 1;
    localStorage.setItem('herohud_extra_demo', String(extra));
    tipAbs("One additional demo granted via Sales University.", .22, .16);
  };

  /* ========= AUDIO ENABLE ========= */
  function enableAudio(){
    STATE.audioEnabled = true;
    try{ window.speechSynthesis.getVoices(); }catch{}
    el.btnEnableAudio.classList.add('locked');
    el.btnEnableAudio.disabled = true;
  }
  el.btnEnableAudio.onclick = ()=> { enableAudio(); boot(); };
  window.addEventListener('load', async ()=>{
    if(!/Mobi|Android|iPhone|iPad/i.test(navigator.userAgent)){
      enableAudio(); boot();
    }
  });

  /* ========= HIDDEN SHORTCUTS (no visible skip/replay UI) ========= */
  window.addEventListener('keydown', (e)=>{
    if(e.key==='s' || e.key==='S'){ // skip speech
      stopSpeech();
    }else if(e.key==='r' || e.key==='R'){ // replay Addie
      stopSpeech();
      const script =
        "Hi again—Addie here. Upload a photo, tap Analyze, and Jared will walk the site with you in plain language. " +
        "I can unlock Access Plus, Best Practices, Field Guides, and the Sales University in the Cardinal Garage.";
      speak(script, { female:true, rate:1.0, pitch:1.06 });
    }
  });

  /* ========= DECK MODE ========= */
  function openDeck(){
    closeGarage();
    el.deckOverlay.style.display='block';
    STATE.deckIndex = 0; updateDeck();
    stopSpeech(); // silence while in deck
  }
  function closeDeck(){ el.deckOverlay.style.display='none'; }
  el.deckPrev.onclick = ()=> { STATE.deckIndex = Math.max(0, STATE.deckIndex-1); updateDeck(); };
  el.deckNext.onclick = ()=> { STATE.deckIndex = Math.min(deckSlides().length-1, STATE.deckIndex+1); updateDeck(); };
  el.deckPrint.onclick = ()=> { window.print(); };
  el.deckExit.onclick = closeDeck;
  document.addEventListener('keydown', (e)=>{
    if(el.deckOverlay.style.display==='block'){
      if(e.key==='ArrowRight') el.deckNext.click();
      if(e.key==='ArrowLeft') el.deckPrev.click();
      if(e.key==='Escape') closeDeck();
    }
  });
  function deckSlides(){ return qsa('#deckOverlay .slide'); }
  function updateDeck(){
    const slides = deckSlides();
    slides.forEach((s,i)=> s.classList.toggle('show', i===STATE.deckIndex));
    el.deckPager.textContent = `${STATE.deckIndex+1} / ${slides.length}`;
  }

  /* ========= HELPERS ========= */
  function tip(text){ tipAbs(text, .5, .5); } // alias

})();
</script>
</body>
</html>
